<html>
<head>
	<title>
		test camera
	</title>
    <script type="text/javascript" charset="utf-8" src="three.js"></script>
    <script type="text/javascript" charset="utf-8" src="OBJLoader.js"></script>
    <script type="text/javascript" charset="utf-8" src="OBJMTLLoader.js"></script>

	
	<script type="text/javascript">
	function init(){
		var renderer = new THREE.WebGLRenderer({
			canvas: document.getElementById("mainCanvas")
		});

		//renderer.setClearColor(0x000000);
		renderer.setClearColor(0xababfe);
		renderer.shadowMapEnabled = true;
		//alert("alert");	
		
		var scene = new THREE.Scene();

		//var camera = new THREE.OrthographicCamera(-800,800,600,-600,1,10000);
		var camera = new THREE.PerspectiveCamera(45,4/3,0.1,1000);
		camera.position.set(-30,40,100);
		camera.lookAt(new THREE.Vector3(0,0,0));
		scene.add(camera);

        var spotLight = new THREE.DirectionalLight(0xffff00);
        spotLight.position.set(-30, 40, 120);
        spotLight.intensity = 1;
        scene.add(spotLight);

        var step = 0;

		// var loader = new THREE.JSONLoader(true);
	 //    loader.load("nomtlcar.js", function ( geometry ) {
		// 	// var loading = document.getElementById("Loading");
		// 	// loading.parentNode.removeChild(loading);
		// 	obj = new THREE.Mesh(geometry, material);
		// 	obj.position.set(0,0,12000);
		// 	scene.add(obj);
		// 	var start = new Date().getTime(),delta;
		// 	(function anime(){
		// 		delta = new Date().getTime() - start;
		// 		obj.rotation.y =   delta / 1000;
		// 		renderer.render(scene, camera);
		// 		return requestAnimationFrame(anime);
		// 	})();

	 //    	renderer.render(scene,camera);
		// });
		var mesh;
		var loader = new THREE.OBJLoader();
        loader.load('test2.obj', function (geometry) {
            var material = new THREE.MeshLambertMaterial({color: 0xff0000});

            // geometry.children.forEach(function (child) {
            //     if (child.children.length == 1) {
            //         if (child.children[0] instanceof THREE.Mesh) {
            //             child.children[0].material = material;
            //         }
            //     }
            // });

        	geometry.traverse(function(child){
        		if(child instanceof THREE.Mesh){
        			child.material.side = THREE.DoubleSide;
        		}
        	});

            mesh = geometry;
            geometry.scale.set(50, 50, 50);
            geometry.rotation.x = -0.1;
            scene.add(geometry);
        });
		// var loader = new THREE.OBJMTLLoader();
		// loader.addEventListener('load',function(event){
		// 	var obj = event.content;
		// 	mesh = obj;
		// 	scene.add(obj);
		// });
		// loader.load('test2.obj','test2.mtl');

        render();
        function render() {

            if (mesh) {
                mesh.rotation.y += 0.008;
                mesh.rotation.x += 0.008;
            }
            requestAnimationFrame(render);
            renderer.render(scene, camera);
        }        

		//renderer.render(scene,camera);
		/*
		var cube = new THREE.Mesh(new THREE.CubeGeometry(2,2,1),
			new THREE.MeshBasicMaterial({
				color:0xff0000,
				wireframe:true
			})
		);


		scene.add(cube);

/*		var plane = new THREE.Mesh(new THREE.PlaneGeometry(100,80), 
			new THREE.MeshBasicMaterial({
				color:0x0000ff,
				wireframe:true
			})
		);
		scene.add(plane);*/


		// var material = new THREE.MeshLambertMaterial({
		// 	color:0xff0000
		// });

		// var geometry = new THREE.CubeGeometry(1,2,3);

		// var mesh = new THREE.Mesh(geometry,material);
		// scene.add(mesh);

		//renderer.render(scene,camera);
	}
	</script>
</head>
<body onload="init()">
	<canvas id="mainCanvas" width="1200px" height="900px">
	</canvas>
</body>
</html>